two.z <- two.species$aov.table[[1,6]]
two.rand.mean <- mean(two.species$random.SS)
two.rand.sd <- sd(two.species$random.SS)
two.species #significant
#manova for 3 species (A1, A2, and D5)
A1A2D5.species <- procD.lm(cluster_table~A1A2D5)
A1A2D5.z <- A1A2D5.species$aov.table[[1,6]]
A1A2D5.rand.mean <- mean(A1A2D5.species$random.SS)
A1A2D5.rand.sd <- sd(A1A2D5.species$random.SS)
A1A2D5.species #significant
#manova for 2 species, and wild progenitor (D5, A, and A1-73 as wild progenitor)
A1.ancestral.species <- procD.lm(cluster_table~A1.ancestral)
A1.ancestral.z <- A1.ancestral.species$aov.table[[1,6]]
A1.ancestral.rand.mean <- mean(A1.ancestral.species$random.SS)
A1.ancestral.rand.sd <- sd(A1.ancestral.species$random.SS)
A1.ancestral.species #significant
#####Z-tests
#can be compared to Z distribution. See Adams & Collyer, 2016 Evolution. "On the comparison of the strengthof morphological integration acrossmorphometric datasets "
A1A2D5.z.test <- (((two.z-two.rand.mean)-(A1A2D5.z - A1A2D5.rand.mean)) / sqrt((two.rand.sd)^2 + (A1A2D5.rand.sd)^2))
A1.ancestral.z.test <- (((two.z-two.rand.mean)-(A1.ancestral.z - A1.ancestral.rand.mean)) / sqrt((two.rand.sd)^2 + (A1.ancestral.rand.sd)^2))
##results of z-test
A1A2D5.z.test
#p-value of x-score for 0.48 is .6844; for z-score of 0.49 is .6879
A1.ancestral.z.test
#p-value for Z-score of 0.57 is 0.7175; p-value for a-score of 0.58 is 0.7190
=======
table_clusters <- read.table("table_clusters.txt", header = TRUE, sep = "\t", stringsAsFactors = FALSE)
library(contrast)
table_clusters
table_clusters
table_clusters
library(nlme)
Orthodont2 <- Orthodont
Orthodont2$newAge <- Orthodont$age - 11
fm1Orth.lme2 <- lme(distance ~ Sex*newAge, data = Orthodont2, random = ~ newAge | Subject)
summary(fm1Orth.lme2)
contrast(fm1Orth.lme2,
a = list(Sex = levels(Orthodont2$Sex), newAge = 8 - 11),
b = list(Sex = levels(Orthodont2$Sex), newAge = 10 - 11))
install.packages("vegan")
data(dune)
data(dune.env)
mod <- cca(dune ~ Management, dune.env)
attach(dune.env)
plot(mod, type="n", scaling = "symmetric")
## Catch the invisible result of ordihull...
pl <- ordihull(mod, Management, scaling = "symmetric", label = TRUE)
## ... and find centres and areas of the hulls
summary(pl)
## use more colours and add ellipsoid hulls
plot(mod, type = "n")
pl <- ordihull(mod, Management, scaling = "symmetric", col = 1:4,
draw="polygon", label =TRUE)
ordiellipse(mod, Management, scaling = "symmetric", kind = "ehull",
col = 1:4, lwd=3)
## ordispider to connect WA and LC scores
plot(mod, dis=c("wa","lc"), type="p")
ordispider(mod)
## Other types of plots
plot(mod, type = "p", display="sites")
cl <- hclust(vegdist(dune))
ordicluster(mod, cl, prune=3, col = cutree(cl, 4))
## confidence ellipse: location of the class centroids
plot(mod, type="n", display = "sites")
text(mod, display="sites", labels = as.character(Management),
col=as.numeric(Management))
pl <- ordiellipse(mod, Management, kind="se", conf=0.95, lwd=2,
draw = "polygon", col=1:4, border=1:4, alpha=63)
summary(pl)
## add confidence bars
ordibar(mod, Management, kind="se", conf=0.95, lwd=2, col=1:4, label=TRUE)
library(vegan)
data(dune)
data(dune.env)
mod <- cca(dune ~ Management, dune.env)
attach(dune.env)
plot(mod, type="n", scaling = "symmetric")
## Catch the invisible result of ordihull...
pl <- ordihull(mod, Management, scaling = "symmetric", label = TRUE)
## ... and find centres and areas of the hulls
summary(pl)
## use more colours and add ellipsoid hulls
plot(mod, type = "n")
pl <- ordihull(mod, Management, scaling = "symmetric", col = 1:4,
draw="polygon", label =TRUE)
ordiellipse(mod, Management, scaling = "symmetric", kind = "ehull",
col = 1:4, lwd=3)
## ordispider to connect WA and LC scores
plot(mod, dis=c("wa","lc"), type="p")
ordispider(mod)
## Other types of plots
plot(mod, type = "p", display="sites")
cl <- hclust(vegdist(dune))
ordicluster(mod, cl, prune=3, col = cutree(cl, 4))
## confidence ellipse: location of the class centroids
plot(mod, type="n", display = "sites")
text(mod, display="sites", labels = as.character(Management),
col=as.numeric(Management))
pl <- ordiellipse(mod, Management, kind="se", conf=0.95, lwd=2,
draw = "polygon", col=1:4, border=1:4, alpha=63)
summary(pl)
## add confidence bars
ordibar(mod, Management, kind="se", conf=0.95, lwd=2, col=1:4, label=TRUE)
>>>>>>> 78d60dc6083af5fd89e20f5da3b4b90caa488e63
new_table = cluster_table
new_table <- cluster_table
library(lazyeval)
library(ggplot2)
library(factoextra)
cluster_table <- read.table("table_clusters.txt", header = T)
cluster_table <- as.data.frame(cluster_table)
cluster_table <- head(cluster_table,1000)
cluster_table <- t(cluster_table)
cluster.pca <- prcomp(cluster_table, scale = TRUE, na.rm = TRUE)
cluster.eig <- get_eigenvalue(cluster.pca)
ind.coord <- cluster.pca$x
subsections <- as.data.frame(cluster_table[,1:2])
subsections$sub <-c("A1", "A1", "A1", "A2", "A2", "A2", "A2", "D5", "D5", "D5", "D5", "A2", "D5")
subsections <- subsections[,-c(1:2)]
subfac <- as.factor(subsections)
png("cotton_outgroup.PCA.direct.annot.new.png", 1000, 1000, pointsize=20)
fviz_pca_ind(cluster.pca, habillage=subfac) + theme_minimal()
dev.off()
new_table = cluster_table
row.names(new_table) <- c("A1", "A1", "A1", "A2", "A2", "A2", "A2", "D5", "D5", "D5", "D5", "A2", "D5")
melted <- melt(new_table)
Y <- melted$value
install.packages(""reshape2"")
install.packages("reshape2")
library(reshape2)
new_table = cluster_table
row.names(new_table) <- c("A1", "A1", "A1", "A2", "A2", "A2", "A2", "D5", "D5", "D5", "D5", "A2", "D5")
melted <- melt(new_table)
Y <- melted$value
Species <- as.factor(melted$Var1)
Cluster <- as.factor(melted$Var2)
anova(lm(Y~Cluster*Species))
glm(A1~A2, data=glmclust)
glm(A1~A2, data=melted)
View(new_table)
View(melted)
lm(A1~A2, data=melted)
lm(Species$A1~Species$A2, data=melted)
new_table <- t(new_table)
glm(A1~A2, data=melted)
new_table <- as.data.frame(t(new_table))
glm(A1~A2, data=melted)
glm(A1~A2, data=new_table)
new_table <- as.data.frame(t(new_table))
glm(A1~A2, data=new_table)
linear_model <- glm(A1~A2, data=new_table)
linear_model
ggplot(new_table, aes(x=A1, y=A2)) + geom_point(size-2) + abline(intercept=0, slope=1)
ggplot(new_table, aes(x=A1, y=A2)) + geom_point(size=2) + abline(intercept=0, slope=1)
ggplot(as.data.frame(new_table), aes(x=A1, y=A2)) + geom_point(size=2) + abline(intercept=0, slope=1)
library(ggplot2)
ggplot(as.data.frame(new_table), aes(x=A1, y=A2)) + geom_point(size=2) + abline(intercept=0, slope=1)
ggplot(as.data.frame(new_table), aes(x=A1, y=A2)) + geom_point(size=2) + geom_abline(intercept=0, slope=1)
ggplot(new_table, aes(x=A1, y=A2)) + geom_point(size=2) + geom_abline(intercept=0, slope=1)
ggplot(new_table) + geom_point(size=2) + geom_abline(intercept=0, slope=1)
?glm
linear_model <- glm(A1~A2, data=new_table, family = poisson)
ggplot(new_table, x=A1, y=A2) + geom_point(size=2) + geom_abline(intercept=0, slope=1)
ggplot(new_table, aes(x=A1, y=A2)) + geom_point(size=2) + geom_abline(intercept=0, slope=1)
new_table = cluster_table
row.names(new_table) <- c("A1", "A1-73", "A1", "A2", "A2", "A2", "A2", "D5", "D5", "D5", "D5", "A2", "D5")
new_table <- as.data.frame(t(new_table))
linear_model <- glm(A1~A2, data=new_table, family = poisson)
ggplot(new_table, aes(x=A1, y=A2)) + geom_point(size=2) + geom_abline(intercept=0, slope=1)
ggplot(new_table, aes(x=A1, y=A2)) + geom_point(size=2) + geom_abline(intercept=0, slope=1)
ggplot(new_table, aes(x=A1, y=A2)) + geom_point(size=2) + geom_abline(intercept=0, slope=1)
new_table <- as.data.frame(t(new_table))
linear_model <- glm(A1~A2, data=new_table)
new_table = cluster_table
row.names(new_table) <- c("A1", "A1-73", "A1", "A2", "A2", "A2", "A2", "D5", "D5", "D5", "D5", "A2", "D5")
new_table
new_table <- as.data.frame(t(new_table))
linear_model <- glm(A1~A2, data=new_table)
ggplot(new_table, aes(x=A1, y=A2)) + geom_point(size=2) + geom_abline(intercept=0, slope=1)
new_table = cluster_table
row.names(new_table) <- c("A1", "A1", "A1", "A2", "A2", "A2", "A2", "A2", "D5", "D5", "D5", "D5", "D5")
new_table <- as.data.frame(t(new_table))
linear_model <- glm(A1~A2, data=new_table)
ggplot(new_table, aes(x=A1, y=A2)) + geom_point(size=2) + geom_abline(intercept=0, slope=1)
new_table = cluster_table
row.names(new_table) <- c("A1", "A1", "A1", "A2", "A2", "A2", "A2", "A2", "D5", "D5", "D5", "D5", "D5")
new_table <- as.data.frame(t(new_table))
linear_model <- glm(A1~A2, data=new_table)
ggplot(linear_model, aes(x=A1, y=A2)) + geom_point(size=2) + geom_abline(intercept=0, slope=1)
row.names(new_table) <- c("A1", "A1", "A1", "A2", "A2", "A2", "D5", "A2", "D5", "D5", "D5", "D5", "D5")
new_table = cluster_table
row.names(new_table) <- c("A1", "A1", "A1", "A2", "A2", "A2", "D5", "A2", "D5", "D5", "D5", "D5", "D5")
new_table <- as.data.frame(t(new_table))
linear_model <- glm(A1~A2, data=new_table)
ggplot(linear_model, aes(x=A1, y=A2)) + geom_point(size=2) + geom_abline(intercept=0, slope=1)
ggplot(new_table, aes(x=A1, y=A2)) + geom_point(size=2) + geom_abline(intercept=0, slope=1)
new_table = cluster_table
row.names(new_table) <- c("A1", "A1", "A1", "A2", "A2", "A2", "D5", "A2", "D5", "D5", "D5", "A2", "D5")
new_table <- as.data.frame(t(new_table))
new_table = cluster_table
row.names(new_table) <- c("A1", "A1", "A1", "A2", "A2", "A2", "A2", "D5", "D5", "D5", "D5", "A2", "D5")
new_table <- as.data.frame(t(new_table))
linear_model <- glm(A1~A2, data=new_table)
ggplot(new_table, aes(x=A1, y=A2)) + geom_point(size=2) + geom_abline(intercept=0, slope=1)
annot_clust <- read.table("annotated.counts", header = T, row.names=1, sep="\t")
getwd()
annot_clust <- read.table("annotated.counts", header = T, row.names=1, sep="\t")
annot_clust$cluster <- NULL
View(annot_clust)
annot_clust <- read.table("FileS3.xls")
Kbamount <- data.frame(annot_clust[1], apply(annot_clust[2:16], 2, function (x) x*9.5))
annot_clust$cluster <- NULL
Kbamount <- data.frame(annot_clust[1], apply(annot_clust[2:16], 2, function (x) x*9.5))
annot_clust <- read.table("annotated.counts", header = T, row.names=1, sep="\t")
annot_clust$cluster <- NULL
Kbamount <- data.frame(annot_clust[1], apply(annot_clust[2:16], 2, function (x) x*9.5))
KBsum <- aggregate(. ~Lineage, data=Kbamount, FUN=sum)
View(Kbamount)
View(KBsum)
KBsum$A1 <- rowMeans(KBsum[,2:4])
KBsum$A2 <- rowMeans(KBsum[,5:9])
KBsum$D5 <- rowMeans(KBsum[,10:14])
KBsum$A1min <- apply(KBsum[,2:4], 1, min)
KBsum$A2min <- apply(KBsum[,5:9], 1, min)
KBsum$D5min <- apply(KBsum[,10:14], 1, min)
KBsum$kirkiimin <- KBsum$kirkii
KBsum$kokia_min <- KBsum$kokia_
KBsum$A1max <- apply(KBsum[,2:4], 1, max)
KBsum$A2max <- apply(KBsum[,5:9], 1, max)
KBsum$D5max <- apply(KBsum[,10:14], 1, max)
KBsum$kirkiimax <- KBsum$kirkii
KBsum$kokia_max <- KBsum$kokia_
KBsum <- KBsum[,-(2:14)]
KBm <- melt(KBsum[,-(7:16)])
min <- c(KBsum$kirkiimin, KBsum$kokia_min, KBsum$A1min, KBsum$A2min, KBsum$D5min)
max <- c(KBsum$kirkiimax, KBsum$kokia_max, KBsum$A1max, KBsum$A2max, KBsum$D5max)
KBm$min <- min
KBm$max <- max
library(reshape2)
KBsum <- KBsum[,-(2:14)]
KBm <- melt(KBsum[,-(7:16)])
min <- c(KBsum$kirkiimin, KBsum$kokia_min, KBsum$A1min, KBsum$A2min, KBsum$D5min)
max <- c(KBsum$kirkiimax, KBsum$kokia_max, KBsum$A1max, KBsum$A2max, KBsum$D5max)
KBm$min <- min
KBm$max <- max
View(KBm)
limits <- aes(ymax=KBm$max, ymin=KBm$min)
library(ggplot2)
limits <- aes(ymax=KBm$max, ymin=KBm$min)
dodge <- position_dodge(width=0.9)
png("Figure_TE.amounts.png", 1000, 1000, pointsize=20)
ggplot(KBm, aes(x=Lineage, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("kirkii", "kokia_", "A1", "A2", "D5"), values=c("blue3", "green3", "orchid", "orchid4", "slategrey")) + geom_errorbar(limits, position = dodge)
dev.off()
sum(KBsum$kirkii)/1000
[1] 110.3615
sum(KBsum$kokia_)/1000
[1] 109.4685
ggplot(KBm, aes(x=Lineage, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("kirkii", "kokia_", "A1", "A2", "D5"), values=c("blue3", "green3", "orchid", "orchid4", "slategrey")) + geom_errorbar(limits, position = dodge)
dev.off()
View(KBm)
min <- c(KBsum$kirkiimin, KBsum$kokia_min, KBsum$A1min, KBsum$A2min, KBsum$D5min)
max <- c(KBsum$kirkiimax, KBsum$kokia_max, KBsum$A1max, KBsum$A2max, KBsum$D5max)
KBm$min <- min
KBm$max <- max
library(ggplot2)
limits <- aes(ymax=KBm$max, ymin=KBm$min)
dodge <- position_dodge(width=0.9)
png("Figure_TE.amounts.png", 1000, 1000, pointsize=20)
ggplot(KBm, aes(x=Lineage, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("kirkii", "kokia_", "A1", "A2", "D5"), values=c("blue3", "green3", "orchid", "orchid4", "slategrey")) + geom_errorbar(limits, position = dodge)
dev.off()
ggplot(KBm, aes(x=Lineage, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("kirkii", "kokia_", "A1", "A2", "D5"), values=c("blue3", "green3", "orchid", "orchid4", "slategrey"))
sum(KBsum$kirkii)/1000
View(annot_clust)
load("C:/Users/erdostal/Desktop/EEOB546xFINALPROJECT/FileS3.xls")
KBsum <- read.table("annotated.megabases", header = TRUE)
KBsum <- read.table("annotated.megabases.xlsx", header = TRUE)
load("C:/Users/erdostal/Desktop/EEOB546xFINALPROJECT/annotated.megabases.xlsx")
View(KBsum)
KBsum <- read.csv("annotated.megabases.xlsx", header = TRUE)
KBsum <- read.csv("countaverages.xlsx", header = TRUE)
KBsum <- read.table("countaverages.xlsx", header = TRUE)
KBsum <- read.table("f.csv", header = TRUE)
View(KBsum)
KBsum <- read.csv("f.csv", header = TRUE)
View(KBsum)
KBsum <- read.csv("f.csv", header = TRUE)
View(KBm)
View(KBsum)
min <- c(KBsum$A1min, KBsum$A2min,KBsum$D5min)
max <- c(KBsum$A1max, KBsum$A2max, KBsum$D5max)
KBm$min <- min
KBm$max <- max
View(KBm)
KBsum <- read.csv("f.csv", header = TRUE)
min <- c(KBsum$A1min, KBsum$A2min,KBsum$D5min)
max <- c(KBsum$A1max, KBsum$A2max, KBsum$D5max)
KBm$min <- min
KBm <- melt(KBsum)
View(KBm)
KBm$min <- min
KBm$max <- max
View(KBm)
library(ggplot2)
limits <- aes(ymax=KBm$max, ymin=KBm$min)
limits <- aes(ymax=KBm$max, ymin=KBm$min)
dodge <- position_dodge(width=0.9)
png("Figure_TE.amounts.png", 1000, 1000, pointsize=20)
ggplot(KBm, aes(x=Lineage, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("kirkii", "kokia_", "A1", "A2", "D5"), values=c("blue3", "green3", "orchid", "orchid4", "slategrey"))+ geom_errorbar(limits, position = dodge)
annot_clust <- read.table("annotated.counts", header = T, row.names=1, sep="\t")
View(annot_clust)
ggplot(KBm, aes(x=X, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("kirkii", "kokia_", "A1", "A2", "D5"), values=c("blue3", "green3", "orchid", "orchid4", "slategrey"))+ geom_errorbar(limits, position = dodge)
ggplot(KBm, aes(x=X, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("A1", "A2", "D5"), values=c("blue3", "green3", "orchid", "orchid4", "slategrey"))+ geom_errorbar(limits, position = dodge)
ggplot(KBm, aes(x=X, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("A1", "A2", "D5"), values=c("blue3", "green3", "orchid"))+ geom_errorbar(limits, position = dodge)
ggplot(KBm, aes(x=X, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("A1", "A2", "D5")+ geom_errorbar(limits, position = dodge)
#### kirkii vs kokia clusters ####
png("Figure_TE.comparisons.png", 1000, 1000, pointsize=20)
p1 <- ggplot(annot_clust, aes(x=kokia_, y=kirkii, shape=signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1) + scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3")) +  scale_x_continuous(expand = c(0, 0), limits=c(0,750)) + scale_y_continuous(expand = c(0, 0), limits=c(0,750))
p2 <- ggplot(annot_clust[annot_clust$Lineage == "LTR", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,400)) + scale_y_continuous(expand = c(0, 0), limits=c(0,400))
p3 <- ggplot(annot_clust[annot_clust$Lineage == "LTR/Gypsy", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,750)) + scale_y_continuous(expand = c(0, 0), limits=c(0,750))
p4 <- ggplot(annot_clust[annot_clust$Lineage == "LTR/Copia", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,150)) + scale_y_continuous(expand = c(0, 0), limits=c(0,150))
grid.arrange(p1,p2,p3,p4, ncol=2)
dev.off()
>>>>>>> e96254db25f62eb526e9e086b783720381db962b
ggplot(KBm, aes(x=X, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("A1", "A2", "D5")+ geom_errorbar(limits, position = dodge)
#### kirkii vs kokia clusters ####
png("Figure_TE.comparisons.png", 1000, 1000, pointsize=20)
p1 <- ggplot(annot_clust, aes(x=kokia_, y=kirkii, shape=signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1) + scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3")) +  scale_x_continuous(expand = c(0, 0), limits=c(0,750)) + scale_y_continuous(expand = c(0, 0), limits=c(0,750))
p2 <- ggplot(annot_clust[annot_clust$Lineage == "LTR", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,400)) + scale_y_continuous(expand = c(0, 0), limits=c(0,400))
p3 <- ggplot(annot_clust[annot_clust$Lineage == "LTR/Gypsy", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,750)) + scale_y_continuous(expand = c(0, 0), limits=c(0,750))
p4 <- ggplot(annot_clust[annot_clust$Lineage == "LTR/Copia", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,150)) + scale_y_continuous(expand = c(0, 0), limits=c(0,150))
grid.arrange(p1,p2,p3,p4, ncol=2)
dev.off()
>>>>>>> e96254db25f62eb526e9e086b783720381db962b
ggplot(KBm, aes(x=X, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("A1", "A2", "D5")+ geom_errorbar(limits, position = dodge)
#### kirkii vs kokia clusters ####
png("Figure_TE.comparisons.png", 1000, 1000, pointsize=20)
p1 <- ggplot(annot_clust, aes(x=kokia_, y=kirkii, shape=signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1) + scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3")) +  scale_x_continuous(expand = c(0, 0), limits=c(0,750)) + scale_y_continuous(expand = c(0, 0), limits=c(0,750))
p2 <- ggplot(annot_clust[annot_clust$Lineage == "LTR", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,400)) + scale_y_continuous(expand = c(0, 0), limits=c(0,400))
p3 <- ggplot(annot_clust[annot_clust$Lineage == "LTR/Gypsy", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,750)) + scale_y_continuous(expand = c(0, 0), limits=c(0,750))
p4 <- ggplot(annot_clust[annot_clust$Lineage == "LTR/Copia", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,150)) + scale_y_continuous(expand = c(0, 0), limits=c(0,150))
grid.arrange(p1,p2,p3,p4, ncol=2)
dev.off()
>>>>>>> e96254db25f62eb526e9e086b783720381db962b
ggplot(KBm, aes(x=X, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("A1", "A2", "D5")+ geom_errorbar(limits, position = dodge)
#### kirkii vs kokia clusters ####
png("Figure_TE.comparisons.png", 1000, 1000, pointsize=20)
p1 <- ggplot(annot_clust, aes(x=kokia_, y=kirkii, shape=signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1) + scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3")) +  scale_x_continuous(expand = c(0, 0), limits=c(0,750)) + scale_y_continuous(expand = c(0, 0), limits=c(0,750))
p2 <- ggplot(annot_clust[annot_clust$Lineage == "LTR", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,400)) + scale_y_continuous(expand = c(0, 0), limits=c(0,400))
p3 <- ggplot(annot_clust[annot_clust$Lineage == "LTR/Gypsy", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,750)) + scale_y_continuous(expand = c(0, 0), limits=c(0,750))
p4 <- ggplot(annot_clust[annot_clust$Lineage == "LTR/Copia", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,150)) + scale_y_continuous(expand = c(0, 0), limits=c(0,150))
grid.arrange(p1,p2,p3,p4, ncol=2)
dev.off()
>>>>>>> e96254db25f62eb526e9e086b783720381db962b
library(ggplot2)
ggplot(KBm, aes(x=X, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("A1", "A2", "D5")+ geom_errorbar(limits, position = dodge)
#### kirkii vs kokia clusters ####
png("Figure_TE.comparisons.png", 1000, 1000, pointsize=20)
p1 <- ggplot(annot_clust, aes(x=kokia_, y=kirkii, shape=signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1) + scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3")) +  scale_x_continuous(expand = c(0, 0), limits=c(0,750)) + scale_y_continuous(expand = c(0, 0), limits=c(0,750))
p2 <- ggplot(annot_clust[annot_clust$Lineage == "LTR", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,400)) + scale_y_continuous(expand = c(0, 0), limits=c(0,400))
p3 <- ggplot(annot_clust[annot_clust$Lineage == "LTR/Gypsy", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,750)) + scale_y_continuous(expand = c(0, 0), limits=c(0,750))
p4 <- ggplot(annot_clust[annot_clust$Lineage == "LTR/Copia", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,150)) + scale_y_continuous(expand = c(0, 0), limits=c(0,150))
grid.arrange(p1,p2,p3,p4, ncol=2)
dev.off()
>>>>>>> e96254db25f62eb526e9e086b783720381db962b
library(scales)
limits <- aes(ymax=KBm$max, ymin=KBm$min)
dodge <- position_dodge(width=0.9)
png("Figure_TE.amounts.png", 1000, 1000, pointsize=20)
ggplot(KBm, aes(x=X, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("A1", "A2", "D5")+ geom_errorbar(limits, position = dodge)
#### kirkii vs kokia clusters ####
png("Figure_TE.comparisons.png", 1000, 1000, pointsize=20)
p1 <- ggplot(annot_clust, aes(x=kokia_, y=kirkii, shape=signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1) + scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3")) +  scale_x_continuous(expand = c(0, 0), limits=c(0,750)) + scale_y_continuous(expand = c(0, 0), limits=c(0,750))
p2 <- ggplot(annot_clust[annot_clust$Lineage == "LTR", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,400)) + scale_y_continuous(expand = c(0, 0), limits=c(0,400))
p3 <- ggplot(annot_clust[annot_clust$Lineage == "LTR/Gypsy", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,750)) + scale_y_continuous(expand = c(0, 0), limits=c(0,750))
p4 <- ggplot(annot_clust[annot_clust$Lineage == "LTR/Copia", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,150)) + scale_y_continuous(expand = c(0, 0), limits=c(0,150))
grid.arrange(p1,p2,p3,p4, ncol=2)
dev.off()
>>>>>>> e96254db25f62eb526e9e086b783720381db962b
library(gridExtra)
ggplot(KBm, aes(x=X, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("A1", "A2", "D5")+ geom_errorbar(limits, position = dodge)
#### kirkii vs kokia clusters ####
png("Figure_TE.comparisons.png", 1000, 1000, pointsize=20)
p1 <- ggplot(annot_clust, aes(x=kokia_, y=kirkii, shape=signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1) + scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3")) +  scale_x_continuous(expand = c(0, 0), limits=c(0,750)) + scale_y_continuous(expand = c(0, 0), limits=c(0,750))
p2 <- ggplot(annot_clust[annot_clust$Lineage == "LTR", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,400)) + scale_y_continuous(expand = c(0, 0), limits=c(0,400))
p3 <- ggplot(annot_clust[annot_clust$Lineage == "LTR/Gypsy", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,750)) + scale_y_continuous(expand = c(0, 0), limits=c(0,750))
p4 <- ggplot(annot_clust[annot_clust$Lineage == "LTR/Copia", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,150)) + scale_y_continuous(expand = c(0, 0), limits=c(0,150))
grid.arrange(p1,p2,p3,p4, ncol=2)
dev.off()
>>>>>>> e96254db25f62eb526e9e086b783720381db962b
KBsum <- read.csv("f.csv", header = TRUE)
library(reshape2)
KBsum <- read.csv("f.csv", header = TRUE)
library(reshape2)
min <- c(KBsum$A1min, KBsum$A2min,KBsum$D5min)
max <- c(KBsum$A1max, KBsum$A2max, KBsum$D5max)
KBm <- melt(KBsum)
KBm$min <- min
KBm$max <- max
library(ggplot2)
library(scales)
library(gridExtra)
limits <- aes(ymax=KBm$max, ymin=KBm$min)
dodge <- position_dodge(width=0.9)
png("Figure_TE.amounts.png", 1000, 1000, pointsize=20)
ggplot(KBm, aes(x=X, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("A1", "A2", "D5")+ geom_errorbar(limits, position = dodge)
#### kirkii vs kokia clusters ####
png("Figure_TE.comparisons.png", 1000, 1000, pointsize=20)
p1 <- ggplot(annot_clust, aes(x=, y=kirkii, shape=signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1) + scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3")) +  scale_x_continuous(expand = c(0, 0), limits=c(0,750)) + scale_y_continuous(expand = c(0, 0), limits=c(0,750))
p2 <- ggplot(annot_clust[annot_clust$Lineage == "LTR", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,400)) + scale_y_continuous(expand = c(0, 0), limits=c(0,400))
p3 <- ggplot(annot_clust[annot_clust$Lineage == "LTR/Gypsy", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,750)) + scale_y_continuous(expand = c(0, 0), limits=c(0,750))
p4 <- ggplot(annot_clust[annot_clust$Lineage == "LTR/Copia", ], aes(x=kokia_, y=kirkii, shape= signK, color=signK)) + geom_point(size=2) + geom_abline(intercept=0, size=1)+ scale_color_manual(breaks=c("positive", "negative"), values=c("blue3", "green3"))+ scale_x_continuous(expand = c(0, 0), limits=c(0,150)) + scale_y_continuous(expand = c(0, 0), limits=c(0,150))
grid.arrange(p1,p2,p3,p4, ncol=2)
dev.off()
>>>>>>> e96254db25f62eb526e9e086b783720381db962b
View(KBm)
ggplot(KBm, aes(x=X, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("A1", "A2", "D5"))+ geom_errorbar(limits, position = dodge)
ggplot(KBm, aes(x=X, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("A1", "A2", "D5"), values = "Set1")+ geom_errorbar(limits, position = dodge)
ggplot(KBm, aes(x=X, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("A1", "A2", "D5"), values = "blue3", "green3", "orchid", "orchid4", "slategrey","yellow","red","orange","pink"))+ geom_errorbar(limits, position = dodge)
ggplot(KBm, aes(x=X, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("A1", "A2", "D5"), values = "blue3", "green3", "orchid", "orchid4", "slategrey","yellow","red","orange","purple"))+ geom_errorbar(limits, position = dodge)
ggplot(KBm, aes(x=X, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("A1", "A2", "D5"), values = ("blue3", "green3", "orchid", "orchid4", "slategrey","yellow","red","orange","purple"))+ geom_errorbar(limits, position = dodge)
ggplot(KBm, aes(x=X, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("A1", "A2", "D5"), values = ("blue3""green3""orchid""orchid4""slategrey""yellow""red""orange""purple"))+ geom_errorbar(limits, position = dodge)
annot_clust <- read.table("annotated.counts", header = T, row.names=1, sep="\t")
annot_clust$cluster <- NULL
Kbamount <- data.frame(annot_clust[1], apply(annot_clust[2:16], 2, function (x) x*9.5))
KBsum <- aggregate(. ~Lineage, data=Kbamount, FUN=sum)
KBsum$A1 <- rowMeans(KBsum[,2:4])
KBsum$A2 <- rowMeans(KBsum[,5:9])
KBsum$D5 <- rowMeans(KBsum[,10:14])
KBsum$A1min <- apply(KBsum[,2:4], 1, min)
KBsum$A2min <- apply(KBsum[,5:9], 1, min)
KBsum$D5min <- apply(KBsum[,10:14], 1, min)
KBsum$kirkiimin <- KBsum$kirkii
KBsum$kokia_min <- KBsum$kokia_
KBsum$A1max <- apply(KBsum[,2:4], 1, max)
KBsum$A2max <- apply(KBsum[,5:9], 1, max)
KBsum$D5max <- apply(KBsum[,10:14], 1, max)
KBsum$kirkiimax <- KBsum$kirkii
KBsum$kokia_max <- KBsum$kokia_
library(reshape2)
min <- c(KBsum$A1min, KBsum$A2min,KBsum$D5min)
max <- c(KBsum$A1max, KBsum$A2max, KBsum$D5max)
KBm <- melt(KBsum)
KBm$min <- min
KBm$max <- max
library(ggplot2)
KBsum <- read.csv("f.csv", header = TRUE)
library(reshape2)
min <- c(KBsum$A1min, KBsum$A2min,KBsum$D5min)
max <- c(KBsum$A1max, KBsum$A2max, KBsum$D5max)
KBm <- melt(KBsum)
KBm$min <- min
KBm$max <- max
library(ggplot2)
library(scales)
library(gridExtra)
limits <- aes(ymax=KBm$max, ymin=KBm$min)
dodge <- position_dodge(width=0.9)
png("Figure_TE.amounts.png", 1000, 1000, pointsize=20)
ggplot(KBm, aes(x=X, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("A1", "A2", "D5"), values = cols) + geom_errorbar(limits, position = dodge)
cols <- c("red","blue","green","yellow","orange","orchid","orange","darkgreen","orchid4")
ggplot(KBm, aes(x=X, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + scale_y_log10() + scale_fill_manual(breaks=c("A1", "A2", "D5"), values = cols) + geom_errorbar(limits, position = dodge)
png("Figure_TE.comparisons.png", 1000, 1000, pointsize=20)
Lineage	A1_155	A1_073	A1_097	A2_255	A2_034	A2_044	A2_099	A2_101	D5_002	D5_031	D5_004	D5_053	D5_ggg
RLC	36.6985	36.3945	34.732	38.304	38.342	36.2235	37.5535	36.2995	34.827	34.0575	38.342	35.853	35.055
View(KBm)
stable <- read.table("f.csv", sep = "\t", header =TRUE)
View(stable)
stable <- read.table("f.csv", sep = ",", header =TRUE)
stable$A1 <- rowMeans(stable[,2:4])
stable$A2 <- rowMeans(stable[,5:9])
stable$D5 <- rowMeans(stable[,10:14])
library(ggplot2)
library(reshape2)
stable <- read.table("f.csv", sep = ",", header =TRUE)
stable$A1 <- rowMeans(stable[,2:4])
stable$A2 <- rowMeans(stable[,5:9])
stable$D5 <- rowMeans(stable[,10:14])
std <- function(x) sd(x)/sqrt(length(x))
stable$A1err <- apply(stable[,2:4], 1, std)
stable$A2err <- apply(stable[,5:9], 1, std)
stable$D5err <- apply(stable[,10:14], 1, std)
stable$A1min <- stable$A1 - stable$A1err
stable$A2min <- stable$A2 - stable$A2err
stable$D5min <- stable$D5 - stable$D5err
stable$A1max <- stable$A1 + stable$A1err
stable$A2max <- stable$A2 + stable$A2err
stable$D5max <- stable$D5 + stable$D5err
stable <- stable[,-(2:14)]
melted <- melt(stable[,(1:4)])
min <- c(stable$A1min, stable$A2min, stable$D5min)
max <- c(stable$A1max, stable$A2max, stable$D5max)
melted$min <- min
melted$max <- max
limits <- aes(ymax=melted$max, ymin=melted$min)
dodge <- position_dodge(width=0.9)
png("Figure_TE.amounts.png", 7500, 5000, pointsize=12, res=600)
ggplot(melted, aes(x=Lineage, y=value, fill = variable)) + geom_bar(stat = "identity",position = dodge) + geom_errorbar(limits, position = dodge, width=0.3) + labs(y="Mbp/1C", x="") + theme_set(theme_grey(base_size=12)) + scale_fill_hue(l=40)
dev.off()
png("cotton.ordination.png", 5000, 5000, pointsize=12, res=600)
ggplot(cmdpoints, aes(x=V1, y=V2, color=genome, shape=genome)) + geom_point(size=2) + xlab("PCoA component 1") + ylab("PCoA component 2") + scale_color_manual(values=c("A1"="orchid", "A2"="orchid4", "D5"="slategrey","kirkii"="blue3", "kokia"="green3"))+ geom_text_repel(aes(label=species))### Recreate Figure 4 Simon's way
mydata <- t(annot_clust[,-c(1)])
d <- dist(mydata, method = "euclidean")
library(ggplot2)
new_table <- as.data.frame(t(cluster_table))
new_table$A1ave <- rowMeans(subset(new_table, select = c(A1_155_, A1_073_, A1_097_), na.rm = TRUE))
library(ggplot2)
new_table <- as.data.frame(t(cluster_table))
new_table$A1ave <- rowMeans(subset(new_table, select = c(A1_155_, A1_073_, A1_097_), na.rm = TRUE))
new_table$A2ave <- rowMeans(subset(new_table, select = c(A2_255_, A2_034_, A2_044_, A2_099_, A2_101_), na.rm = TRUE))
ggplot(A1ave~A2ave, data=new_table, mapping = aes(x = A1ave, y = A2ave)) + geom_point() + geom_abline(intercept=0, slope=1)
png("cotton.ordination.png", 5000, 5000, pointsize=12, res=600)
ggplot(cmdpoints, aes(x=V1, y=V2, color=genome, shape=genome)) + geom_point(size=2) + xlab("PCoA component 1") + ylab("PCoA component 2") + scale_color_manual(values=c("A1"="orchid", "A2"="orchid4", "D5"="slategrey","kirkii"="blue3", "kokia"="green3"))+ geom_text_repel(aes(label=species))### Recreate Figure 4 Simon's way
